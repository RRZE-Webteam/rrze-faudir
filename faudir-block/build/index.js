(()=>{"use strict";var e,r={192:(e,r,t)=>{const l=window.wp.blocks,o=window.wp.i18n,i=window.wp.blockEditor,s=window.wp.components,a=window.wp.element,n=window.wp.serverSideRender;var d=t.n(n);const c=window.wp.apiFetch;var u=t.n(c);const f=window.ReactJSXRuntime,p=JSON.parse('{"UU":"rrze-faudir/block"}');(0,l.registerBlockType)(p.UU,{edit:function({attributes:e,setAttributes:r}){const[t,l]=(0,a.useState)([]),[n,c]=(0,a.useState)([]),[p,_]=(0,a.useState)(!0),[h,g]=(0,a.useState)(!1),[m,x]=(0,a.useState)(""),{selectedCategory:b="",selectedPosts:z=[],showCategory:j="",showPosts:v="",selectedPersonIds:y="",selectedFormat:k="kompakt",selectedFields:C=[],groupId:w="",functionField:F="",organizationNr:N="",url:T="",buttonText:S="",hideFields:O=[]}=e,P={displayName:(0,o.__)("Display Name","rrze-faudir"),personalTitle:(0,o.__)("Academic Title","rrze-faudir"),givenName:(0,o.__)("First Name","rrze-faudir"),familyName:(0,o.__)("Last Name","rrze-faudir"),personalTitleSuffix:(0,o.__)("Academic Suffix","rrze-faudir"),titleOfNobility:(0,o.__)("Title of Nobility","rrze-faudir"),email:(0,o.__)("Email","rrze-faudir"),phone:(0,o.__)("Phone","rrze-faudir"),organization:(0,o.__)("Organization","rrze-faudir"),function:(0,o.__)("Function","rrze-faudir"),url:(0,o.__)("Url","rrze-faudir"),kompaktButton:(0,o.__)("Kompakt Button","rrze-faudir"),content:(0,o.__)("Content","rrze-faudir"),teasertext:(0,o.__)("Teasertext","rrze-faudir"),socialmedia:(0,o.__)("Social Media","rrze-faudir"),workplaces:(0,o.__)("Workplaces","rrze-faudir"),room:(0,o.__)("Room","rrze-faudir"),floor:(0,o.__)("Floor","rrze-faudir"),street:(0,o.__)("Street","rrze-faudir"),zip:(0,o.__)("Zip","rrze-faudir"),city:(0,o.__)("City","rrze-faudir"),faumap:(0,o.__)("Fau Map","rrze-faudir"),officehours:(0,o.__)("Office Hours","rrze-faudir"),consultationhours:(0,o.__)("Consultation Hours","rrze-faudir")},E={card:["displayName","personalTitle","givenName","familyName","personalTitleSuffix","email","phone","function","socialmedia","titleOfNobility"],table:["displayName","personalTitle","givenName","familyName","personalTitleSuffix","email","phone","url","socialmedia","titleOfNobility"],list:["displayName","personalTitle","givenName","familyName","personalTitleSuffix","email","phone","url","teasertext","titleOfNobility"],kompakt:Object.keys(P),page:Object.keys(P)};(0,a.useEffect)((()=>{e.selectedFields&&0!==e.selectedFields.length||u()({path:"/wp/v2/settings/rrze_faudir_options"}).then((e=>{e?.default_output_fields&&r({selectedFields:e.default_output_fields})})).catch((e=>{console.error("Error fetching default fields:",e)}))}),[]),(0,a.useEffect)((()=>{u()({path:"/wp/v2/custom_taxonomy?per_page=100"}).then((e=>{l(e),_(!1)})).catch((e=>{console.error("Error fetching categories:",e),_(!1)}))}),[]),(0,a.useEffect)((()=>{g(!0),u()({path:"/wp/v2/custom_person",params:{per_page:100,_fields:"id,title,meta",orderby:"title",order:"asc"}}).then((e=>{if(c(e),y&&(!z||0===z.length)){const t=e.filter((e=>e.meta?.person_id&&y.includes(e.meta.person_id))).map((e=>e.id));t.length>0&&r({selectedPosts:t})}g(!1)})).catch((e=>{console.error("Error fetching posts:",e),g(!1)}))}),[]),(0,a.useEffect)((()=>{S||u()({path:"/wp/v2/settings/rrze_faudir_options"}).then((e=>{e?.business_card_title&&(x(e.business_card_title),r({buttonText:e.business_card_title}))})).catch((e=>{console.error("Error fetching button text:",e)}))}),[]),console.log("Edit component rendering with attributes:",e);const I={selectedPersonIds:e.selectedPersonIds,selectedFields:e.selectedFields,selectedFormat:e.selectedFormat,selectedCategory:e.selectedCategory,groupId:e.groupId,functionField:e.functionField,organizationNr:e.organizationNr,url:e.url};console.log("Block attributes:",I);const[B,A]=(0,a.useState)(0);return(0,a.useEffect)((()=>{const e=setTimeout((()=>{A((e=>e+1))}),300);return()=>clearTimeout(e)}),[e]),(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(i.InspectorControls,{children:(0,f.jsxs)(s.PanelBody,{title:(0,o.__)("Settings","rrze-faudir"),children:[(0,f.jsx)(s.ToggleControl,{label:(0,o.__)("Show Category","rrze-faudir"),checked:j,onChange:()=>r({showCategory:!j})}),j&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("h4",{children:(0,o.__)("Select Category","rrze-faudir")}),t.map((e=>(0,f.jsx)(s.CheckboxControl,{label:e.name,checked:b===e.name,onChange:()=>r({selectedCategory:e.name})},e.id)))]}),(0,f.jsx)(s.ToggleControl,{label:(0,o.__)("Show Persons","rrze-faudir"),checked:v,onChange:()=>r({showPosts:!v})}),v&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("h4",{children:(0,o.__)("Select Persons","rrze-faudir")}),h?(0,f.jsx)("p",{children:(0,o.__)("Loading persons...","rrze-faudir")}):n.length>0?n.map((e=>(0,f.jsx)(s.CheckboxControl,{label:e.title.rendered,checked:Array.isArray(z)&&z.includes(e.id),onChange:()=>(e=>{const t=z.includes(e)?z.filter((r=>r!==e)):[...z,e],l=t.map((e=>{const r=n.find((r=>r.id===e));return r?.meta?.person_id||null})).filter(Boolean);r({selectedPosts:t,selectedPersonIds:l})})(e.id,e.meta)},e.id))):(0,f.jsx)("p",{children:(0,o.__)("No posts available.","rrze-faudir")})]}),(0,f.jsx)(s.SelectControl,{label:(0,o.__)("Select Format","rrze-faudir"),value:k||"list",options:[{value:"list",label:(0,o.__)("List","rrze-faudir")},{value:"table",label:(0,o.__)("Table","rrze-faudir")},{value:"card",label:(0,o.__)("Card","rrze-faudir")},{value:"kompakt",label:(0,o.__)("Kompakt","rrze-faudir")},{value:"page",label:(0,o.__)("Page","rrze-faudir")}],onChange:t=>{r({selectedFormat:t}),e.selectedFields&&0!==e.selectedFields.length||u()({path:"/wp/v2/settings/rrze_faudir_options"}).then((e=>{if(e?.default_output_fields){const l=E[t]||[],o=e.default_output_fields.filter((e=>l.includes(e)));r({selectedFields:o})}})).catch((e=>{console.error("Error fetching default fields:",e)}))}}),Object.keys(E).map((t=>k===t?(0,f.jsxs)("div",{children:[(0,f.jsx)("h4",{children:(0,o.__)("Select Fields","rrze-faudir")}),E[t].map((t=>(0,f.jsx)("div",{style:{marginBottom:"8px"},children:(0,f.jsx)(s.CheckboxControl,{label:(0,f.jsx)(f.Fragment,{children:P[t]}),checked:C.includes(t),onChange:()=>(t=>{console.log("Toggling field:",t),console.log("Current selectedFields:",C),console.log("Current hideFields:",e.hideFields);const l=C.includes(t);let o,i=e.hideFields||[];l?(o=C.filter((e=>e!==t)),i=[...i,t]):(o=[...C,t],i=i.filter((e=>e!==t))),console.log("Updated selectedFields:",o),console.log("Updated hideFields:",i),r({selectedFields:o,hideFields:i})})(t)})},t)))]},t):null)),(0,f.jsx)(s.TextControl,{label:(0,o.__)("Group Id","rrze-faudir"),value:w,onChange:e=>r({groupId:e})}),(0,f.jsx)(s.TextControl,{label:(0,o.__)("Function","rrze-faudir"),value:F,onChange:e=>r({functionField:e})}),(0,f.jsx)(s.TextControl,{label:(0,o.__)("Organization Nr","rrze-faudir"),value:N,onChange:e=>r({organizationNr:e})}),(0,f.jsx)(s.TextControl,{label:(0,o.__)("Custom url","rrze-faudir"),value:T,onChange:e=>r({url:e})}),"kompakt"===k&&(0,f.jsx)(s.TextControl,{label:(0,o.__)("Button Text","rrze-faudir"),help:(0,o.__)("Default: ","rrze-faudir")+m,value:S,onChange:e=>r({buttonText:e}),placeholder:m})]})}),(0,f.jsx)("div",{...(0,i.useBlockProps)(),children:e.selectedPersonIds&&e.selectedPersonIds.length>0?(0,f.jsx)(f.Fragment,{children:(0,f.jsx)(d(),{block:"rrze-faudir/block",attributes:e,skipBlockSupportAttributes:!0,EmptyResponsePlaceholder:()=>(0,f.jsxs)("div",{style:{padding:"20px",backgroundColor:"#fff3cd",color:"#856404"},children:[(0,f.jsx)("p",{children:"No content returned from server."}),(0,f.jsxs)("details",{children:[(0,f.jsx)("summary",{children:"Debug Information"}),(0,f.jsx)("pre",{children:JSON.stringify(e,null,2)})]})]}),ErrorResponsePlaceholder:({response:r})=>(0,f.jsxs)("div",{style:{padding:"20px",backgroundColor:"#f8d7da",color:"#721c24"},children:[(0,f.jsx)("p",{children:(0,f.jsx)("strong",{children:"Error loading content:"})}),(0,f.jsx)("p",{children:r?.errorMsg||"Unknown error occurred"}),(0,f.jsxs)("details",{children:[(0,f.jsx)("summary",{children:"Debug Information"}),(0,f.jsx)("pre",{children:"Block: rrze-faudir/block"}),(0,f.jsxs)("pre",{children:["Response: ",JSON.stringify(r,null,2)]}),(0,f.jsxs)("pre",{children:["Attributes: ",JSON.stringify(e,null,2)]})]})]})},B)}):(0,f.jsx)("div",{style:{padding:"20px",backgroundColor:"#f8f9fa",textAlign:"center"},children:(0,f.jsx)("p",{children:"__('Please select persons to display using the sidebar controls.', 'rrze-faudir')"})})})]})},save:()=>null})}},t={};function l(e){var o=t[e];if(void 0!==o)return o.exports;var i=t[e]={exports:{}};return r[e](i,i.exports,l),i.exports}l.m=r,e=[],l.O=(r,t,o,i)=>{if(!t){var s=1/0;for(c=0;c<e.length;c++){for(var[t,o,i]=e[c],a=!0,n=0;n<t.length;n++)(!1&i||s>=i)&&Object.keys(l.O).every((e=>l.O[e](t[n])))?t.splice(n--,1):(a=!1,i<s&&(s=i));if(a){e.splice(c--,1);var d=o();void 0!==d&&(r=d)}}return r}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[t,o,i]},l.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return l.d(r,{a:r}),r},l.d=(e,r)=>{for(var t in r)l.o(r,t)&&!l.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},l.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),(()=>{var e={57:0,350:0};l.O.j=r=>0===e[r];var r=(r,t)=>{var o,i,[s,a,n]=t,d=0;if(s.some((r=>0!==e[r]))){for(o in a)l.o(a,o)&&(l.m[o]=a[o]);if(n)var c=n(l)}for(r&&r(t);d<s.length;d++)i=s[d],l.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return l.O(c)},t=globalThis.webpackChunkblock_faudir=globalThis.webpackChunkblock_faudir||[];t.forEach(r.bind(null,0)),t.push=r.bind(null,t.push.bind(t))})();var o=l.O(void 0,[350],(()=>l(192)));o=l.O(o)})();