(()=>{"use strict";var e,r={192:(e,r,t)=>{const o=window.wp.blocks,l=window.wp.i18n,a=window.wp.blockEditor,i=window.wp.components,s=window.wp.element,n=window.wp.serverSideRender;var d=t.n(n);const c=window.wp.apiFetch;var u=t.n(c);const f=window.ReactJSXRuntime,_=JSON.parse('{"UU":"rrze-faudir/block"}');(0,o.registerBlockType)(_.UU,{edit:function({attributes:e,setAttributes:r}){const[t,o]=(0,s.useState)([]),[n,c]=(0,s.useState)([]),[_,p]=(0,s.useState)(!0),[g,h]=(0,s.useState)(!1),[m,b]=(0,s.useState)(""),[x,z]=(0,s.useState)(null),v=(0,a.useBlockProps)(),{selectedCategory:y="",selectedPosts:C=[],showCategory:F="",showPosts:k="",selectedPersonIds:w="",selectedFormat:j="kompakt",selectedFields:T=[],groupId:S="",function:N="",orgnr:P="",url:O="",buttonText:I="",hideFields:E=[]}=e,B={displayName:(0,l.__)("Display Name","rrze-faudir"),personalTitle:(0,l.__)("Academic Title","rrze-faudir"),givenName:(0,l.__)("First Name","rrze-faudir"),familyName:(0,l.__)("Last Name","rrze-faudir"),personalTitleSuffix:(0,l.__)("Academic Suffix","rrze-faudir"),titleOfNobility:(0,l.__)("Title of Nobility","rrze-faudir"),email:(0,l.__)("Email","rrze-faudir"),phone:(0,l.__)("Phone","rrze-faudir"),organization:(0,l.__)("Organization","rrze-faudir"),function:(0,l.__)("Function","rrze-faudir"),url:(0,l.__)("Url","rrze-faudir"),kompaktButton:(0,l.__)("Kompakt Button","rrze-faudir"),content:(0,l.__)("Content","rrze-faudir"),teasertext:(0,l.__)("Teasertext","rrze-faudir"),socialmedia:(0,l.__)("Social Media","rrze-faudir"),workplaces:(0,l.__)("Workplaces","rrze-faudir"),room:(0,l.__)("Room","rrze-faudir"),floor:(0,l.__)("Floor","rrze-faudir"),street:(0,l.__)("Street","rrze-faudir"),zip:(0,l.__)("Zip","rrze-faudir"),city:(0,l.__)("City","rrze-faudir"),faumap:(0,l.__)("Fau Map","rrze-faudir"),officehours:(0,l.__)("Office Hours","rrze-faudir"),consultationhours:(0,l.__)("Consultation Hours","rrze-faudir")},U={card:["displayName","personalTitle","givenName","familyName","personalTitleSuffix","email","phone","function","socialmedia","titleOfNobility"],table:["displayName","personalTitle","givenName","familyName","personalTitleSuffix","email","phone","url","socialmedia","titleOfNobility"],list:["displayName","personalTitle","givenName","familyName","personalTitleSuffix","email","phone","url","teasertext","titleOfNobility"],kompakt:Object.keys(B),page:Object.keys(B)};(0,s.useEffect)((()=>{e.selectedFields&&0!==e.selectedFields.length||u()({path:"/wp/v2/settings/rrze_faudir_options"}).then((e=>{e?.default_output_fields&&r({selectedFields:e.default_output_fields})})).catch((e=>{console.error("Error fetching default fields:",e)}))}),[]),(0,s.useEffect)((()=>{u()({path:"/wp/v2/custom_taxonomy?per_page=100"}).then((e=>{o(e),p(!1)})).catch((e=>{console.error("Error fetching categories:",e),p(!1)}))}),[]),(0,s.useEffect)((()=>{u()({path:"/wp/v2/settings/rrze_faudir_options"}).then((e=>{e?.default_organization?.orgnr&&(z(e.default_organization.orgnr),N&&!P&&r({orgnr:e.default_organization.orgnr}))})).catch((e=>{console.error("Error fetching default organization number:",e)}))}),[]),(0,s.useEffect)((()=>{h(!0);const e={per_page:100,_fields:"id,title,meta",orderby:"title",order:"asc"};if(y&&(e.custom_taxonomy=y),N){e.function=N;const r=P||x;r&&(e.organization_nr=r)}u()({path:"/wp/v2/custom_person",params:e}).then((e=>{if(c(e),y&&(!C||0===C.length)){const t=e.map((e=>e.id)),o=e.map((e=>e.meta?.person_id)).filter(Boolean);r({selectedPosts:t,selectedPersonIds:o})}h(!1)})).catch((e=>{console.error("Error fetching posts:",e),h(!1)}))}),[y,N,P,x]),(0,s.useEffect)((()=>{I||u()({path:"/wp/v2/settings/rrze_faudir_options"}).then((e=>{e?.business_card_title&&(b(e.business_card_title),r({buttonText:e.business_card_title}))})).catch((e=>{console.error("Error fetching button text:",e)}))}),[]),console.log("Edit component rendering with attributes:",e);const A={selectedPersonIds:e.selectedPersonIds,selectedFields:e.selectedFields,selectedFormat:e.selectedFormat,selectedCategory:e.selectedCategory,groupId:e.groupId,function:e.function,orgnr:e.orgnr,url:e.url};console.log("Block attributes:",A);const[R,D]=(0,s.useState)(0);return(0,s.useEffect)((()=>{const e=setTimeout((()=>{D((e=>e+1))}),300);return()=>clearTimeout(e)}),[e]),(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(a.InspectorControls,{children:(0,f.jsxs)(i.PanelBody,{title:(0,l.__)("Settings","rrze-faudir"),children:[(0,f.jsx)(i.ToggleControl,{label:(0,l.__)("Show Category","rrze-faudir"),checked:F,onChange:()=>r({showCategory:!F})}),F&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("h4",{children:(0,l.__)("Select Category","rrze-faudir")}),t.map((e=>(0,f.jsx)(i.CheckboxControl,{label:e.name,checked:y===e.name,onChange:()=>r({selectedCategory:e.name})},e.id)))]}),(0,f.jsx)(i.ToggleControl,{label:(0,l.__)("Show Persons","rrze-faudir"),checked:k,onChange:()=>r({showPosts:!k})}),k&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("h4",{children:(0,l.__)("Select Persons","rrze-faudir")}),g?(0,f.jsx)("p",{children:(0,l.__)("Loading persons...","rrze-faudir")}):n.length>0?n.map((e=>(0,f.jsx)(i.CheckboxControl,{label:e.title.rendered,checked:Array.isArray(C)&&C.includes(e.id),onChange:()=>(e=>{const t=C.includes(e)?C.filter((r=>r!==e)):[...C,e],o=t.map((e=>{const r=n.find((r=>r.id===e));return r?.meta?.person_id||null})).filter(Boolean);r({selectedPosts:t,selectedPersonIds:o})})(e.id,e.meta)},e.id))):(0,f.jsx)("p",{children:(0,l.__)("No posts available.","rrze-faudir")})]}),(0,f.jsx)(i.SelectControl,{label:(0,l.__)("Select Format","rrze-faudir"),value:j||"list",options:[{value:"list",label:(0,l.__)("List","rrze-faudir")},{value:"table",label:(0,l.__)("Table","rrze-faudir")},{value:"card",label:(0,l.__)("Card","rrze-faudir")},{value:"kompakt",label:(0,l.__)("Kompakt","rrze-faudir")},{value:"page",label:(0,l.__)("Page","rrze-faudir")}],onChange:t=>{r({selectedFormat:t}),e.selectedFields&&0!==e.selectedFields.length||u()({path:"/wp/v2/settings/rrze_faudir_options"}).then((e=>{if(e?.default_output_fields){const o=U[t]||[],l=e.default_output_fields.filter((e=>o.includes(e)));r({selectedFields:l})}})).catch((e=>{console.error("Error fetching default fields:",e)}))}}),Object.keys(U).map((t=>j===t?(0,f.jsxs)("div",{children:[(0,f.jsx)("h4",{children:(0,l.__)("Select Fields","rrze-faudir")}),U[t].map((t=>(0,f.jsx)("div",{style:{marginBottom:"8px"},children:(0,f.jsx)(i.CheckboxControl,{label:(0,f.jsx)(f.Fragment,{children:B[t]}),checked:T.includes(t),onChange:()=>(t=>{console.log("Toggling field:",t),console.log("Current selectedFields:",T),console.log("Current hideFields:",e.hideFields);const o=T.includes(t);let l,a=e.hideFields||[];o?(l=T.filter((e=>e!==t)),a=[...a,t]):(l=[...T,t],a=a.filter((e=>e!==t))),console.log("Updated selectedFields:",l),console.log("Updated hideFields:",a),r({selectedFields:l,hideFields:a})})(t)})},t)))]},t):null)),(0,f.jsx)(i.TextControl,{label:(0,l.__)("Group Id","rrze-faudir"),value:S,onChange:e=>r({groupId:e})}),(0,f.jsx)(i.TextControl,{label:(0,l.__)("Function","rrze-faudir"),value:e.function||"",onChange:e=>r({function:e})}),(0,f.jsx)(i.TextControl,{label:(0,l.__)("Organization Nr","rrze-faudir"),value:P,onChange:e=>{console.log("Setting orgnr:",e),r({orgnr:e})}}),(0,f.jsx)(i.TextControl,{label:(0,l.__)("Custom url","rrze-faudir"),value:O,onChange:e=>r({url:e})}),"kompakt"===j&&(0,f.jsx)(i.TextControl,{label:(0,l.__)("Button Text","rrze-faudir"),help:(0,l.__)("Default: ","rrze-faudir")+m,value:I,onChange:e=>r({buttonText:e}),placeholder:m})]})}),(0,f.jsx)("div",{...v,children:e.selectedPersonIds?.length>0||e.selectedCategory||e.function&&e.orgnr?(0,f.jsx)(d(),{block:"rrze-faudir/block",attributes:{...e.function&&e.orgnr?{function:e.function,orgnr:e.orgnr,selectedFormat:e.selectedFormat,selectedFields:e.selectedFields,buttonText:e.buttonText,url:e.url}:e.selectedCategory?{selectedCategory:e.selectedCategory,selectedFormat:e.selectedFormat,selectedFields:e.selectedFields,buttonText:e.buttonText,url:e.url,groupId:e.groupId}:{selectedPersonIds:e.selectedPersonIds,selectedFields:e.selectedFields,selectedFormat:e.selectedFormat,buttonText:e.buttonText,url:e.url,groupId:e.groupId}}}):(0,f.jsx)("div",{style:{padding:"20px",backgroundColor:"#f8f9fa",textAlign:"center"},children:(0,f.jsx)("p",{children:e.function?(0,l.__)("Please add an organization ID to display results.","rrze-faudir"):(0,l.__)("Please select persons or a category to display using the sidebar controls.","rrze-faudir")})})})]})},save:()=>null})}},t={};function o(e){var l=t[e];if(void 0!==l)return l.exports;var a=t[e]={exports:{}};return r[e](a,a.exports,o),a.exports}o.m=r,e=[],o.O=(r,t,l,a)=>{if(!t){var i=1/0;for(c=0;c<e.length;c++){for(var[t,l,a]=e[c],s=!0,n=0;n<t.length;n++)(!1&a||i>=a)&&Object.keys(o.O).every((e=>o.O[e](t[n])))?t.splice(n--,1):(s=!1,a<i&&(i=a));if(s){e.splice(c--,1);var d=l();void 0!==d&&(r=d)}}return r}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[t,l,a]},o.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return o.d(r,{a:r}),r},o.d=(e,r)=>{for(var t in r)o.o(r,t)&&!o.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},o.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),(()=>{var e={57:0,350:0};o.O.j=r=>0===e[r];var r=(r,t)=>{var l,a,[i,s,n]=t,d=0;if(i.some((r=>0!==e[r]))){for(l in s)o.o(s,l)&&(o.m[l]=s[l]);if(n)var c=n(o)}for(r&&r(t);d<i.length;d++)a=i[d],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(c)},t=globalThis.webpackChunkblock_faudir=globalThis.webpackChunkblock_faudir||[];t.forEach(r.bind(null,0)),t.push=r.bind(null,t.push.bind(t))})();var l=o.O(void 0,[350],(()=>o(192)));l=o.O(l)})();